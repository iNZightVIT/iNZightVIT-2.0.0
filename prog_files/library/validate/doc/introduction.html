<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Mark van der Loo and Edwin de Jonge" />

<meta name="date" content="2019-12-16" />

<title>Introduction to Validate</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to Validate</h1>
<h4 class="author">Mark van der Loo and Edwin de Jonge</h4>
<h4 class="date">2019-12-16</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#a-quick-example">A quick example</a></li>
<li><a href="#using-reference-data">Using reference data</a></li>
<li><a href="#validator-objects">Validator objects</a></li>
<li><a href="#conversion-from-and-to-data.frames">Conversion from and to <code>data.frames</code></a></li>
<li><a href="#validation-rule-syntax">Validation rule syntax</a></li>
<li><a href="#confrontation-objects">Confrontation objects</a></li>
<li><a href="#confrontation-options">Confrontation options</a></li>
<li><a href="#metadata-and-investigating-validator-objects">Metadata and investigating validator objects</a></li>
<li><a href="#validator-objects-and-confrontation-objects-are-reference-objects">Validator objects and confrontation objects are reference objects</a></li>
</ul>
</div>

<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>The validate package is intended to make checking your data easy, maintainable, and reproducible. The package allows you to</p>
<ul>
<li>Test your data set(s) against predefined rules, either in- or cross-data set</li>
<li>Import and export rule sets from structured or free-format files</li>
<li>Investigate and visualize the results of a data validation step</li>
<li>Perform basic rule maintenance tasks</li>
<li>Define and maintain data quality indicators separately from the data</li>
</ul>
<p>There are a few terms related to the infrastructure offered by validate,</p>
<ul>
<li>data set: your data</li>
<li><code>validator</code> an object representing a set of rules your data must satisfy</li>
<li><code>indicator</code> an object representing a set of numerical quality indicators</li>
<li><code>confrontation</code> an object representing the results of confronting data with rules or quality indicators.</li>
</ul>
<p>There is also a single activity, namely</p>
<ul>
<li><code>confront</code>: evaluate the validation rules or quality indicator in the context of one or more data sets.</li>
</ul>
<p>This vignette demonstrates how to apply validation rules. A <a href="indicators.html">second vignette</a> introduces quality indicator rules.</p>
</div>
<div id="a-quick-example" class="section level3">
<h3>A quick example</h3>
<p>Here’s an example demonstrating the typical workflow. We’ll use the built-in <code>women</code> data set (average heights and weights for American women aged 30-39).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(women)
<span class="kw">summary</span>(women)</code></pre></div>
<pre><code>##      height         weight     
##  Min.   :58.0   Min.   :115.0  
##  1st Qu.:61.5   1st Qu.:124.5  
##  Median :65.0   Median :135.0  
##  Mean   :65.0   Mean   :136.7  
##  3rd Qu.:68.5   3rd Qu.:148.0  
##  Max.   :72.0   Max.   :164.0</code></pre>
<p>Validating data is all about checking whether a data set meets presumptions or expectations you have about it, and the validate package makes it easy for you to define those expectations. Let’s do a quick check on variables in the <code>women</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(validate)
cf &lt;-<span class="st"> </span><span class="kw">check_that</span>(women, height <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, height<span class="op">/</span>weight <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)
<span class="kw">summary</span>(cf)</code></pre></div>
<pre><code>##   name items passes fails nNA error warning          expression
## 1   V1    15     15     0   0 FALSE   FALSE          height &gt; 0
## 2   V2    15     15     0   0 FALSE   FALSE          weight &gt; 0
## 3   V3    15      2    13   0 FALSE   FALSE height/weight &gt; 0.5</code></pre>
<p><code>check_that</code> returns an object containing all sorts of information on the validation results. The easiest way to check the results is with <code>summary</code>, which returns a <code>data.frame</code> with the following basic information:</p>
<ul>
<li>How many data items were checked against each rule</li>
<li>How many items passed, failed or resulted in <code>NA</code></li>
<li>Whether the check resulted in an error (could not be performed) or gave an error</li>
<li>The expression that was actually evaluated to perform the check.</li>
</ul>
<p>If you’re a fan of the pipe-operator provided by the <a href="https://CRAN.R-project.org/package=magrittr">magrittr</a>, the above statement can also be performed as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">women <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">check_that</span>(height <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, height<span class="op">/</span>weight <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</code></pre></div>
<p>The same information can be summarized graphically.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(cf,<span class="dt">main=</span><span class="st">&quot;Checks on the women data set&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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Pd6V6miIyEtva2trm5qayKFQVVWl0WgtLS3u7u66urpkeScX+/b5VbzdNCDWYAihzZs3L168WF9f38rK6uzZs1lZWefOnetBO48ePUpPT//++++5D9khhFxcXDq66dqzZ8+2bNmSmpra0tIyatQoaWlpXK6rqyssLKyrq2tnZ4cQIghCUlISP7527Zq7u/ucOXMIghg7dqy7u/ukSZ0dg6HT6Zs2bVq/fj2LxbK0tExMTNyzZ8/27dt7sIq2tbU1NzdPTU2d8KPO587bJe47wOHHeO+xoyHCl966u7uXlJQcOXLk+fPneCiys7PZbLaYmNj8+fMRQjo6OlOmTDE0NMSbyqNHj+Z53YKCAm1t7c8d1T4xUAK2YMECFovl7+/v5eVlamp6+/ZtExOTHrSTnp6OEPLz8+Mpnzp1arsBq6qqGj169IwZMyIjI0eNGkUQxKhRo7p8FXy9aVlZ2e3bt48ePTp16tRXr15paWl1Msvq1asFBAROnDhx4MABTU1NvCvyOUv2X8LCwjdu3ODe2uxDxcXF5GN8jEFZWbnzIcJDoampaWho+PHjRzwU+F3A4UQIZWVlZWVlIYTweb/CwsJ2b8DYg1HtvQGxiYgtXrw4NTW1qqrq/v37PIclum/ZsmXtnrDv6CeDk5KSGhoafH19LS0tCYKora3t6MpRKSmpH3/8EfXietPly5enpqbW1tampaUtX768x/eslZWVNTQ07Nm8nQsODiYfnz9/XkxMTF9fv5MhIociNzc3KiqKHApZWVljY+Pq6mo8+Phq96tXr1pbW3d0sW+fX8XbTQNlDdYJfCpM4ZfODmo3tLR429j0oHEtLS06ne7j47NgwYLKysrdu3ezWKyEhITXr193dPih7683/XyioqL71wYICHb4++5sFmeYsdnnNhsZGbl27Vp7e/sHDx74+vq6u7tLSEh0MkQdDUV5eXm75XJych1d7NvLUWUwGAG3XoU/6OzXnGvqW9q5joRPl2R92Wpqaiq70tra2v0GV6xYMXHiRPz4/Pnz2traYmJilpaW4eHhd+/etbCwwBcKqqiokFcMysnJHT9+HD/u2+tNe6CxsbHLAamvr+9+g/hfIcPDw6dMmSIlJaWrq+vj48Nms/GznQxRR0PRUXknF/v2ZlTxWdPOVVVVtZ1xoFyLCPpXfn6+urp6cnKyubl5f/eFrwbQPhgA/AcBA4BCsIkIAIVgDQYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhSBgAFAIAgYAhf4PNWNEg8rEKSMAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="using-reference-data" class="section level3">
<h3>Using reference data</h3>
<p>For some checks it is convenient to compare the data under scrutiny with other data artifacts. Two common examples include:</p>
<ul>
<li>Data is checked against an earlier version of the same dataset.</li>
<li>We wish to check the contents of a column against a code list, and we do not want to put the code list hard-coded into the rule set.</li>
</ul>
<p>For this, we can use the <code>ref</code> option in confront. Here is how to compare columns from two data frames row-by-row. The user has to make sure that the rows of the data set under scrutiny (<code>women</code>) matches row-wise with the reference data set (<code>women1</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">women1 &lt;-<span class="st"> </span>women
rules &lt;-<span class="st"> </span><span class="kw">validator</span>(height <span class="op">==</span><span class="st"> </span>women_reference<span class="op">$</span>height)
cf &lt;-<span class="st"> </span><span class="kw">confront</span>(women, rules, <span class="dt">ref =</span> <span class="kw">list</span>(<span class="dt">women_reference =</span> women1))
<span class="kw">summary</span>(cf)</code></pre></div>
<pre><code>##   name items passes fails nNA error warning
## 1   V1    15     15     0   0 FALSE   FALSE
##                              expression
## 1 height == women_reference[, &quot;height&quot;]</code></pre>
<p>Here is how to make a code list available.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rules &lt;-<span class="st"> </span><span class="kw">validator</span>( fruit <span class="op">%in%</span><span class="st"> </span>codelist )
fruits &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;orange&quot;</span>)
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">fruit =</span> <span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>,<span class="st">&quot;broccoli&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;banana&quot;</span>))
cf &lt;-<span class="st"> </span><span class="kw">confront</span>(dat, rules, <span class="dt">ref =</span> <span class="kw">list</span>(<span class="dt">codelist =</span> fruits))
<span class="kw">summary</span>(cf)</code></pre></div>
<pre><code>##   name items passes fails nNA error warning           expression
## 1   V1     4      3     1   0 FALSE   FALSE fruit %vin% codelist</code></pre>
</div>
<div id="validator-objects" class="section level3">
<h3>Validator objects</h3>
<p>Validator objects are used to store, investigate and manipulate rule sets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">validator</span>(height <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, height<span class="op">/</span>weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
v</code></pre></div>
<pre><code>## Object of class 'validator' with 3 elements:
##  V1: height &gt; 0
##  V2: weight &gt; 0
##  V3: height/weight &gt; 0</code></pre>
<p>The validator object has stored the rule and assigned names to them for future reference. To check this, we confront the data set with the validation rules we’ve just defined:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cf &lt;-<span class="st"> </span><span class="kw">confront</span>(women,v)
cf</code></pre></div>
<pre><code>## Object of class 'validation'
## Call:
##     confront(dat = women, x = v)
## 
## Confrontations: 3
## With fails    : 0
## Warnings      : 0
## Errors        : 0</code></pre>
<p>The object <code>cf</code> contains the result of checking the data in <code>women</code> against the expectations in <code>v</code>. The fact that there are no warnings or errors means that indeed each rule could be evaluated successfully (an error would occur for example, if we’d misspell height). Now let’s take a look at the actual results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(cf)</code></pre></div>
<pre><code>##   name items passes fails nNA error warning        expression
## 1   V1    15     15     0   0 FALSE   FALSE        height &gt; 0
## 2   V2    15     15     0   0 FALSE   FALSE        weight &gt; 0
## 3   V3    15     15     0   0 FALSE   FALSE height/weight &gt; 0</code></pre>
<p>Now, suppose that we expect that the BMI (weight divided by height squared) of each item to be below 23. We need to express the weight in kg and the height in meters, so the equation for BMI becomes <span class="math display">\[
BMI = \frac{weight\times0.45359}{(height\times0.0254)^2}
\]</span> Moreover, assume that we suspect that the average BMI is between 22 and 22.5. Let’s create another validator object that first computes the BMI and next tests whether the BMI values conform to our suspicion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">validator</span>(
  BMI <span class="op">:</span><span class="er">=</span><span class="st"> </span>(weight<span class="op">*</span><span class="fl">0.45359</span>)<span class="op">/</span>(height<span class="op">*</span><span class="fl">0.0254</span>)<span class="op">^</span><span class="dv">2</span>
  , height <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>
  , weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>
  , BMI <span class="op">&lt;</span><span class="st"> </span><span class="dv">23</span>
  , <span class="kw">mean</span>(BMI) <span class="op">&gt;</span><span class="st"> </span><span class="dv">22</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">mean</span>(BMI) <span class="op">&lt;</span><span class="st"> </span><span class="fl">22.5</span>
)
v</code></pre></div>
<pre><code>## Object of class 'validator' with 5 elements:
##  V1: `:=`(BMI, (weight * 0.45359)/(height * 0.0254)^2)
##  V2: height &gt; 0
##  V3: weight &gt; 0
##  V4: BMI &lt; 23
##  V5: mean(BMI) &gt; 22 &amp; mean(BMI) &lt; 22.5</code></pre>
<p>Checking is easy as before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cf &lt;-<span class="st"> </span><span class="kw">confront</span>(women,v)
<span class="kw">summary</span>(cf)</code></pre></div>
<pre><code>##   name items passes fails nNA error warning
## 1   V2    15     15     0   0 FALSE   FALSE
## 2   V3    15     15     0   0 FALSE   FALSE
## 3   V4    15     10     5   0 FALSE   FALSE
## 4   V5     1      0     1   0 FALSE   FALSE
##                                                                                                expression
## 1                                                                                              height &gt; 0
## 2                                                                                              weight &gt; 0
## 3                                                             (weight * 0.45359)/(height * 0.0254)^2 &lt; 23
## 4 mean((weight * 0.45359)/(height * 0.0254)^2) &gt; 22 &amp; mean((weight * 0.45359)/(height * 0.0254)^2) &lt; 22.5</code></pre>
<p>Observe that the expressions for validation are now manipulated: everywhere where <code>BMI</code> was used, it was replaced with the computation defined before.</p>
</div>
<div id="conversion-from-and-to-data.frames" class="section level3">
<h3>Conversion from and to <code>data.frames</code></h3>
<p>Validator objects can be read from and converted to <code>data.frames</code>. To create a validator object, at least a character column named <code>rule</code> is necessary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">rule =</span> <span class="kw">c</span>(<span class="st">&quot;height&gt;0&quot;</span>,<span class="st">&quot;weight&gt;0&quot;</span>,<span class="st">&quot;height/weight&gt;0.5&quot;</span>)
  , <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;height positive&quot;</span>,<span class="st">&quot;weight positive&quot;</span>,<span class="st">&quot;ratio limit&quot;</span>)
)
v &lt;-<span class="st"> </span><span class="kw">validator</span>(<span class="dt">.data=</span>df)
v</code></pre></div>
<pre><code>## Object of class 'validator' with 3 elements:
##  V1 [height positive]: height &gt; 0
##  V2 [weight positive]: weight &gt; 0
##  V3 [ratio limit]    : height/weight &gt; 0.5</code></pre>
<p>Now confront with the data and merge back with rule metadata.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cf &lt;-<span class="st"> </span><span class="kw">confront</span>(women, v)
quality &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(cf)
measure &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(v)
<span class="kw">head</span>( <span class="kw">merge</span>(quality, measure) )</code></pre></div>
<pre><code>##   name value expression           label description origin             created
## 1   V1  TRUE height &gt; 0 height positive                    2019-12-16 15:51:22
## 2   V1  TRUE height &gt; 0 height positive                    2019-12-16 15:51:22
## 3   V1  TRUE height &gt; 0 height positive                    2019-12-16 15:51:22
## 4   V1  TRUE height &gt; 0 height positive                    2019-12-16 15:51:22
## 5   V1  TRUE height &gt; 0 height positive                    2019-12-16 15:51:22
## 6   V1  TRUE height &gt; 0 height positive                    2019-12-16 15:51:22
##         language severity       rule
## 1 validate 0.9.3    error height &gt; 0
## 2 validate 0.9.3    error height &gt; 0
## 3 validate 0.9.3    error height &gt; 0
## 4 validate 0.9.3    error height &gt; 0
## 5 validate 0.9.3    error height &gt; 0
## 6 validate 0.9.3    error height &gt; 0</code></pre>
<p>Or, merge with the summarized results. The result of <code>summary</code> is just a <code>data.frame</code> (tidy, isn’t it?).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">merge</span>(<span class="kw">summary</span>(cf),measure)</code></pre></div>
<pre><code>##   name items passes fails nNA error warning          expression           label
## 1   V1    15     15     0   0 FALSE   FALSE          height &gt; 0 height positive
## 2   V2    15     15     0   0 FALSE   FALSE          weight &gt; 0 weight positive
## 3   V3    15      2    13   0 FALSE   FALSE height/weight &gt; 0.5     ratio limit
##   description origin             created       language severity
## 1                    2019-12-16 15:51:22 validate 0.9.3    error
## 2                    2019-12-16 15:51:22 validate 0.9.3    error
## 3                    2019-12-16 15:51:22 validate 0.9.3    error
##                  rule
## 1          height &gt; 0
## 2          weight &gt; 0
## 3 height/weight &gt; 0.5</code></pre>
</div>
<div id="validation-rule-syntax" class="section level3">
<h3>Validation rule syntax</h3>
<p>Conceptually, any R statement that will evaluate to a <code>logical</code> is considered a validating statement. The validate package checks this when the user defines a rule set, so for example calling <code>validator( mean(height) )</code> will result in a warning since just computing <code>mean(x)</code> does not validate anything.</p>
<p>You will find a concise description of the syntax in the <code>syntax</code> help file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?syntax</code></pre></div>
<p>Examples of various types of rules can also be found <a href="https://github.com/data-cleaning/ValidatPoC">here</a>.</p>
<p>In short, you can use</p>
<ul>
<li>Type checks: any function starting with <code>is.</code>.</li>
<li>Binary comparisons: <code>&lt;, &lt;=, ==, !=, &gt;=, &gt;</code> and <code>%in%</code>.</li>
<li>Unary logical operators: <code>!, all(), any()</code>.</li>
<li>Binary logical operators: <code>&amp;, &amp;&amp;, |, ||</code> and logical implication, e.g. <code>if (staff &gt; 0) staff.costs &gt; 0</code>.</li>
<li>Text search: <code>grepl</code></li>
<li><a href="https://en.wikipedia.org/wiki/Functional_dependency">Functional dependency</a>: <span class="math inline">\(X\to Y + Z\)</span> is represented by <code>X ~ Y + Z</code>.</li>
</ul>
<p>There are some convenience functions.</p>
<ul>
<li>Inspect the whole data set using <code>.</code>, e.g. <code>validator( nrow(.) &gt; 10)</code>.</li>
<li>Reuse a variable using <code>:=</code>, e.g. <code>validator(m := mean(x), x &lt; 2*mean(x) )</code>.</li>
<li>Apply the same rule to multiple groups with <code>var_group</code>, e.g. <code>validator(G:=var_group(x,y), G &gt; 0)</code>.</li>
</ul>
</div>
<div id="confrontation-objects" class="section level3">
<h3>Confrontation objects</h3>
<p>The outcome of confronting a validator object with a data set is an object of class <code>confrontation</code>. There are several ways to extract information from a <code>confrontation</code> object.</p>
<ul>
<li><code>summary</code>: summarize output; returns a <code>data.frame</code></li>
<li><code>aggregate</code>: aggregate validation in several ways</li>
<li><code>sort</code> : aggregate and sort in several ways</li>
<li><code>values</code>: Get the values in an array, or a list of arrays if rules have different output dimension structure</li>
<li><code>errors</code>: Retrieve error messages caught during the confrontation</li>
<li><code>warnings</code>: Retrieve warning messages caught during the confrontation.</li>
</ul>
<p>By default aggregates are produced by rule.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cf &lt;-<span class="st"> </span><span class="kw">check_that</span>(women, height<span class="op">&gt;</span><span class="dv">0</span>, weight<span class="op">&gt;</span><span class="dv">0</span>,height<span class="op">/</span>weight <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>)
<span class="kw">aggregate</span>(cf) </code></pre></div>
<pre><code>##    npass nfail nNA rel.pass rel.fail rel.NA
## V1    15     0   0      1.0      0.0      0
## V2    15     0   0      1.0      0.0      0
## V3    12     3   0      0.8      0.2      0</code></pre>
<p>To aggregate by record, use <code>by='record'</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">aggregate</span>(cf,<span class="dt">by=</span><span class="st">'record'</span>))</code></pre></div>
<pre><code>##   npass nfail nNA  rel.pass  rel.fail rel.NA
## 1     2     1   0 0.6666667 0.3333333      0
## 2     2     1   0 0.6666667 0.3333333      0
## 3     2     1   0 0.6666667 0.3333333      0
## 4     3     0   0 1.0000000 0.0000000      0
## 5     3     0   0 1.0000000 0.0000000      0
## 6     3     0   0 1.0000000 0.0000000      0</code></pre>
<p>Aggregated results can be automatically sorted, so records with the most violations or rules that are violated most sort higher.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># rules with most violations sorting first:</span>
<span class="kw">sort</span>(cf)</code></pre></div>
<pre><code>##    npass nfail nNA rel.pass rel.fail rel.NA
## V3    12     3   0      0.8      0.2      0
## V1    15     0   0      1.0      0.0      0
## V2    15     0   0      1.0      0.0      0</code></pre>
<p>Confrontation objects can be subsetted with single bracket operators (like vectors), to obtain a sub-object pertaining only to the selected rules.</p>
<pre><code>summary(cf[c(1,3)])</code></pre>
</div>
<div id="confrontation-options" class="section level3">
<h3>Confrontation options</h3>
<p>By default, all errors and warnings are caught when validation rules are confronted with data. This can be switched off by setting the <code>raise</code> option to <code>&quot;errors&quot;</code> or <code>&quot;all&quot;</code>. The following example contains a specification error: <code>hite</code> should be <code>height</code> and therefore the rule errors on the <code>women</code> data.frame because it does not contain a column <code>hite</code>. The error is caught (not resulting in a R error) and shown in the summary,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">validator</span>(hite <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, weight<span class="op">&gt;</span><span class="dv">0</span>)
<span class="kw">summary</span>(<span class="kw">confront</span>(women, v))</code></pre></div>
<pre><code>##   name items passes fails nNA error warning expression
## 1   V1     0      0     0   0  TRUE   FALSE   hite &gt; 0
## 2   V2    15     15     0   0 FALSE   FALSE weight &gt; 0</code></pre>
<p>Setting <code>raise</code> to <code>all</code> results in a R error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this gives an error</span>
<span class="kw">confront</span>(women, v, <span class="dt">raise=</span><span class="st">'all'</span>)</code></pre></div>
<pre><code>## Error in fun(...): object 'hite' not found</code></pre>
<p>Linear equalities form an important class of validation rules. To prevent equalities to be strictly tested, there is an option called <code>len.eq.eps</code> (with default value <span class="math inline">\(10^{-8}\)</span>) that allows one to add some slack to these tests. The amount of slack is intended to prevent false negatives (unneccesary failures) caused by machine rounding. If you want to check whether a sum-rule is satisfied to within one or two units of measurement, it is cleaner to define two inequalities for that.</p>
</div>
<div id="metadata-and-investigating-validator-objects" class="section level3">
<h3>Metadata and investigating validator objects</h3>
<p>Validator objects store a set of rules, optionally with some metadata per rule. Currently, the following functions can be used to get or set metadata:</p>
<ul>
<li><code>origin</code> : Where was a rule defined?</li>
<li><code>names</code> : The name per rule</li>
<li><code>created</code> : when were the rules created?</li>
<li><code>label</code> : Short description of the rule</li>
<li><code>description</code>: Long description of the rule</li>
<li><code>meta</code>: Set or get generic metadata</li>
</ul>
<p>For example, names can be set from the command line when defining a validator object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">validator</span>(<span class="dt">rat =</span> height<span class="op">/</span>weight <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">htest=</span>height<span class="op">&gt;</span><span class="dv">0</span>, <span class="dt">wtest=</span>weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
<span class="kw">names</span>(v)</code></pre></div>
<pre><code>## [1] &quot;rat&quot;   &quot;htest&quot; &quot;wtest&quot;</code></pre>
<p>Also try</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(v)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;ratio&quot;</span>
v</code></pre></div>
<pre><code>## Object of class 'validator' with 3 elements:
##  ratio: height/weight &gt; 0.5
##  htest: height &gt; 0
##  wtest: weight &gt; 0</code></pre>
<p>It is also possible to add generic key-value pairs as metadata. Getting and setting follows the usual recycling rules of R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># add 'foo' to the first rule:</span>
<span class="kw">meta</span>(v[<span class="dv">1</span>],<span class="st">&quot;foo&quot;</span>) &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="co"># Add 'bar' to all rules</span>
<span class="kw">meta</span>(v,<span class="st">&quot;bar&quot;</span>) &lt;-<span class="st"> &quot;baz&quot;</span></code></pre></div>
<p>Metadata can be made visible by selecting a single rule:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## 
## Object of class rule.
##  expr       : height/weight &gt; 0.5 
##  name       : ratio 
##  label      :  
##  description:  
##  origin     : command-line 
##  created    : 2019-12-16 15:51:22
##  meta       : language&lt;chr&gt;, severity&lt;chr&gt;, foo&lt;nmr&gt;, bar&lt;chr&gt;</code></pre>
<p>Or by extracting it to a <code>data.frame</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">meta</span>(v)</code></pre></div>
<pre><code>##    name label description       origin             created       language
## 1 ratio                   command-line 2019-12-16 15:51:22 validate 0.9.3
## 2 htest                   command-line 2019-12-16 15:51:22 validate 0.9.3
## 3 wtest                   command-line 2019-12-16 15:51:22 validate 0.9.3
##   severity foo bar
## 1    error   1 baz
## 2    error  NA baz
## 3    error  NA baz</code></pre>
<p>Some general information is obtained with <code>summary</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(v)</code></pre></div>
<pre><code>##   block nvar rules linear
## 1     1    2     3      2</code></pre>
<p>Here, some properties per <em>block</em> of rules is given. Two rules occur in the same block if when they share a variable. In this case, all rules occur in the same block.</p>
<p>and the number of rules can be requested with <code>length</code></p>
<pre><code>length(v)</code></pre>
<p>With <code>variables</code>, the variables occurring per rule, or over all the rules can be requested.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">variables</span>(v)</code></pre></div>
<pre><code>## [1] &quot;height&quot; &quot;weight&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">variables</span>(v,<span class="dt">as=</span><span class="st">&quot;matrix&quot;</span>)</code></pre></div>
<pre><code>##        variable
## rule    height weight
##   ratio   TRUE   TRUE
##   htest   TRUE  FALSE
##   wtest  FALSE   TRUE</code></pre>
<p>Validator objects can be subsetted as if they were lists using the single and double bracket operators.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</code></pre></div>
<pre><code>## Object of class 'validator' with 2 elements:
##  ratio: height/weight &gt; 0.5
##  wtest: weight &gt; 0
## Rules are evaluated using locally defined options</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v[<span class="kw">c</span>(<span class="st">'ratio'</span>,<span class="st">'wtest'</span>)]</code></pre></div>
<pre><code>## Object of class 'validator' with 2 elements:
##  ratio: height/weight &gt; 0.5
##  wtest: weight &gt; 0
## Rules are evaluated using locally defined options</code></pre>
<p>The double bracket can be used to inspect a single rule</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## 
## Object of class rule.
##  expr       : height/weight &gt; 0.5 
##  name       : ratio 
##  label      :  
##  description:  
##  origin     : command-line 
##  created    : 2019-12-16 15:51:22
##  meta       : language&lt;chr&gt;, severity&lt;chr&gt;, foo&lt;nmr&gt;, bar&lt;chr&gt;</code></pre>
</div>
<div id="validator-objects-and-confrontation-objects-are-reference-objects" class="section level3">
<h3>Validator objects and confrontation objects are reference objects</h3>
<p>As simple as that. If you do</p>
<pre><code>w &lt;- v</code></pre>
<p>for a validator object <code>v</code>, then <code>w</code> just points to the same physical object as <code>v</code>. To make an actual copy, you can select everything.</p>
<pre><code>w &lt;- v[]</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
